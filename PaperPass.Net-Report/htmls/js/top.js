(function(o,d){var t=o.operateState.getHeaderState(Report.report_id);e(t);d(".HeaderButton").click(function(){var t=d(".paper-header").css("display");o.operateState.saveHeaderState(Report.report_id,t);e(t);E()});function e(t){if(t=="block"||t==""){d(".paper-header").hide();d("#m-content").css("top","40px");d(".overall-similarity").show();d(".header_logo").show();d(".clickimg").css("background-position","-10px -98px");d(".dropdown-menu ul").css("top","40px")}else{d(".paper-header").show();d("#m-content").css("top","140px");d(".overall-similarity").hide();d(".header_logo").hide();d(".clickimg").css("background-position","-71px -98px");d(".dropdown-menu ul").css("top","140px")}}var c=o.operateState.getLanguage(Report.report_id);if(c!=""){c=typeof multilingual[c]=="undefined"?"English":c}else{c=typeof multilingual[user_language]=="undefined"?"English":user_language}r(c);function r(e){d("*[data-lang]").each(function(){var t=d(this).data().lang;d(this).html(multilingual[e][t])})}var i=o.operateState.getALink(Report.report_id);var a=o.operateState.getTabName(Report.report_id);n(a);l();d("#childIframe").attr("src",i);d("#m-nav .active_li").each(function(){var t=d(this).find(".detailed_description").data().lang;if(a==t){d(this).addClass("active");d(this).siblings().removeClass("active")}if(a=="UseHelp"){d("#nav_ul .active_li.active").removeClass("active")}});d("#m-nav .active_li").click(function(){var t=d(this).find(".detailed_description").data().lang;var e=d(this).find("a").attr("href");o.operateState.saveALink(Report.report_id,e);o.operateState.saveTabName(Report.report_id,t);n(t);if(t=="UseHelp"){d("#nav_ul .active_li.active").removeClass("active")}});function n(t){var e="";if(t==""||t=="DetailReport"){e+='<div class="layui_fixed_layer"></div>'+'<div class="layui_loading_shade">'+'<div class="layui-layer main_layer">'+'<div class="layui-layer-content">'+multilingual[c].LoadingReport+"</div>"+"</div>"+"</div>";d("#m-content").append(e);var i=o.operateState.getFoldState(Report.report_id);s(i)}}function s(t){if(t=="none"){d(".layui_loading_shade").css("width","100%")}else{d(".layui_loading_shade").css("width","70%")}}function l(){var t=document.documentElement.clientWidth;d("#nav_ul li").each(function(){if(t>1280){d(".tab li a").css("padding","0 20px");d(".nav-tit h4").css("font-size","20px")}else{d(".tab li a").css("padding","0 10px");d(".nav-tit h4").css("font-size","16px")}})}d(".dropdown-toggle").click(function(){if(d(".download-format").css("display")=="block"){d(".customize-select .dropdown-menu ul").css("right","123px")}else{d(".customize-select .dropdown-menu ul").css("right","81px")}d(".customize-select .dropdown-menu").toggle();d(".customize-select .caret").css({transform:"rotate(180deg)"})});d(".dropdown-menu *[data-option]").each(function(){if(c==d(this).data().option){d(".customize-select-text").html(d(this).html());d(".dropdown-menu").find("li.selected").removeClass("selected");d(this).parent("li").addClass("selected")}});d(document).on("click",".customize-select .dropdown-menu li > a",function(t){t.preventDefault();location.reload();var e=d(this).text();var i=d(this).parent("li");if(!i.hasClass("ignore")){var a=d(".customize-select");var n=a.attr("data-name");var s=a.find('input[name="'+n+'"]');d(".dropdown-menu").find("li.selected").removeClass("selected");i.addClass("selected");a.find(".customize-select-text").html(e);s.val(e)}var l=d(this).attr("data-option");c=typeof multilingual[l]=="undefined"?"English":l;r(c);o.operateState.saveLanguage(Report.report_id,c);C.contentWindow.postMessage({leng:c},"*")});d(".download-format").click(function(){d(this).find(".dropdown-menu").toggle()});d(".customize-select .dropdown-menu").click(function(){d(this).hide();d(".customize-select .caret").css({transform:"rotate(0deg)"})});d(".help_img,.download_img").mousemove(function(){d(this).parents(".ML20").find(".detailed_description").css("display","block")}).mouseout(function(){d(this).parents(".ML20").find(".detailed_description").css("display","none")});window.addEventListener("message",function(t){if(t.data.bodyDOM&&t.data.sheetCSS){y(t.data.bodyDOM,t.data.sheetCSS)}if(t.data=="switch-detail-text"){o.operateState.saveInitDetailReport(Report.report_id,"text");n("DetailReport");d(".popover").css("visibility","hidden")}if(t.data=="switch-detail-word"){o.operateState.saveInitDetailReport(Report.report_id,"word");n("DetailReport");d(".popover").css("visibility","hidden")}if(t.data=="Page_Loading"){d(".layui_loading_shade").remove();d(".layui_fixed_layer").remove()}if(t.data.FoldState){z(t.data.FoldState)}if(t.data=="get_language"){C.contentWindow.postMessage({leng:c},"*")}});function p(t){var e="";e+='<div class="popover bookmark" id="'+t+'">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[c].DirectoryNavigation+"</div>"+'<div class="mclick_show"><span>[</span><span class="mclick_span">'+multilingual[c].ExpandAll+'</span><i class="g-arrow-i"></i><span>]</span></div>'+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="popover-content">'+'<div class="overflow_ul"></div>'+"</div>"+"</div>"+"</div>";d("#m-content").append(e)}function v(t){var i="";if(t.length==0){i+='<div style="text-align: center;margin-left: -40px;padding: 15px 0;">'+multilingual[c].EmptyDirectoryNavigation+"</div>"}else{t.forEach(t=>{var e=t.children!="undefined"&&t.children&&t.children.length?v(t.children):null;if(e!=null){i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_img mselect_img_detail"></div>'+'<div class="mselect_tit">'+'<a href="htmls/standard_report.html'+t.anchorPoint+'" target="left" class="third-class">'+t.content+"</a>"+"</div>"+"</div>"+e+"</div>"}else{i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_tit ML20">'+'<a href="htmls/standard_report.html'+t.anchorPoint+'" target="left" class="third-class">'+t.content+"</a>"+"</div>"+"</div>"+"</div>"}})}return i}function u(t){return JSON.stringify(JSON.parse(t)).replace(/</g,"&lt;").replace(/>/g,"&gt;")}p("detail_report");var h=JSON.parse(u(detail_json));v=v(h);d("#detail_report .overflow_ul").html(v);d(".overflow_ul").children(".layui-nav-third-child").removeClass("layui-nav-third-child");d(".third-class").each(function(){var t=40;var e=d(this).text().trim();var i=e.length;if(i>t){d(this).html(e.substring(0,t)+"...")}});d(".mselect_img").click(function(){var t=d(this).parent().siblings(".layui-nav-third-child");if(d(this).hasClass("opened")){t.hide();t.find(".mselect_img").removeClass("opened");t.find(".mselect_img").css("background-position","-115px -245px");d(this).css("background-position","-115px -245px");d(this).removeClass("opened")}else{t.show();d(this).css("background-position","-77px -245px");d(this).addClass("opened")}});function m(t){var i=true;d.each(t,function(t,e){if(!d(e).hasClass("opened")){i=false}});if(i){d(".mclick_span").text(multilingual[c].CollapseAll);d("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"})}else{d(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"})}}d(".mselect_img_detail").click(function(){var t=d(".mselect_img_detail");m(t)});if(d(".layui-nav-third-child").length==0){d(".mclick_show").hide()}d(".mclick_show").click(function(){var t=d(this).parent().parent().next().find(".layui-nav-third-child");var e=d(this).parent().parent().next().find(".mselect_img");if(t.is(":hidden")){if(d(this).find(".mclick_span").text()==multilingual[c].CollapseAll){t.hide();e.css("background-position","-115px -245px");d(this).find(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});d(".mselect_img").removeClass("opened")}else{t.show();e.css("background-position","-77px -245px");d(this).find(".mclick_span").text(multilingual[c].CollapseAll);d("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"});d(".mselect_img").addClass("opened")}}else{t.hide();e.css("background-position","-115px -245px");d(this).find(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});d(".mselect_img").removeClass("opened")}});var g="";g+='<div class="popover bookmark" id="page_navigation">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[c].WebpageNavigation+"</div>"+'<ul class="nav-btns clearfix">'+"<li><span></span></li>"+'<li class="active"><span></span></li>'+"<li><span></span></li>"+"</ul>"+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="overflow_ul">'+'<div id="mbxsgxktna" style="width: 284px;"></div>'+"</div>"+"</div>"+"</div>";d("#m-content").append(g);function f(t){if(t==""){d(".nav-btns").hide();t+='<div style="float:none;color:#000000">'+multilingual[c].EmptyWebPageNavigation+"</div>"}else{d(".nav-btns").show()}return t}var _=document.createElement("style");d("head").append(_);function y(t,e){d("style").html(e);var i=f(t);d("#mbxsgxktna").html(i);var a=document.querySelectorAll(".upkmzjakmc");d.each(a,function(){d(this).css("transform","scale(1)");var t=this.getBoundingClientRect().width;var e=this.getBoundingClientRect().height;var i=t/e;var a=155/e;var n=110/t;if(i<793.33/1121.33){d(this).css("transform","scale("+a+")")}else{d(this).css("transform","scale("+n+")")}t=this.getBoundingClientRect().width;e=this.getBoundingClientRect().height;d(this).parent(".jcjymywwzd").css("width",Math.ceil(t));d(this).parent(".jcjymywwzd").css("height",e);w();var s=d(this).parent(".jcjymywwzd").attr("id");var l='<div class="page-nav-id">'+s+"</div>";d(this).parent(".jcjymywwzd").append(l)});d("#Add_height").remove()}function w(){d.each(d(".jcjymywwzd"),function(t,e){var i=this.getBoundingClientRect().width;var a=(112-i)/2+15;d(this).css("margin-left",a).css("margin-right",a)})}function x(i,a){d(".jcjymywwzd").removeClass("active");d(".upkmzjakmc").each(function(t){if(i==t+1){d(this).parent(".jcjymywwzd").addClass("active");if(a=="false"){if(this.nextElementSibling!=null)this.nextElementSibling.scrollIntoView(false)}var e=document.getElementById("childIframe");e.contentWindow.postMessage({page_nav_click:"false"},"*")}});w()}d(document).on("click",".nav-btns li",function(){d(this).siblings().removeClass("active");d(this).addClass("active");d("#page_navigation").find("li").each(function(t,e){var t=t+1;if(t==1&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","142px");b(t)}else if(t==2&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","284px");b(t)}else if(t==3&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","426px");b(t)}})});function b(t){var e=o.operateState.getInitDetailReport(Report.report_id);if(e=="word"||e==""){o.operateState.savePageNavState(Report.report_id,t)}else{o.operateState.savePTPageNavState(Report.report_id,t)}}function k(){var t=o.operateState.getInitDetailReport(Report.report_id);if(t=="word"||t==""){return o.operateState.getPageNavState(Report.report_id)}else{return o.operateState.getPTPageNavState(Report.report_id)}}d(document).delegate(".upkmzjakmc","click",function(){d(".jcjymywwzd").removeClass("active");d(this).parent(".jcjymywwzd").addClass("active");var t=d(this).parent(".jcjymywwzd").attr("id");var e={EnterId:t,page_nav_click:"true"};C.contentWindow.postMessage(e,"*");w()});function S(t){d("#page_navigation").find(".nav-btns li").each(function(){if(d(this).hasClass("active")){d(this).removeClass("active")}});if(t=="1"){d("#page_navigation").find(".nav-btns li:first-child").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","142px")}else if(t=="2"||t==""){d("#page_navigation").find(".nav-btns li:nth-child(2)").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","284px")}else if(t=="3"){d("#page_navigation").find(".nav-btns li:last-child").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","426px")}}d("#m-nav a").click(function(){d(".popover").css("visibility","hidden")});var C=document.getElementById("childIframe");var R=o.Paper.tab();var j=o.Paper.textSectionSave(null);d(function(){if("undefined"===typeof localStorage||"undefined"===typeof JSON){d("body").append('<div class="alert-warning"><p>'+multilingual[c].SupportBrowser+"</p></div>")}d(document).on("click",'[tab-a="ul"] .active_li',function(){R.call(this)});var t={visibility:"hidden",leng:c};d(".close").click(function(){d(".popover").css("visibility","hidden");C.contentWindow.postMessage(t,"*")});C.contentWindow.postMessage(t,"*");d(document).on("click","[tpl-section-save=btn]",function(){j.call(this)});d(document).on("click","[tpl-section-cancle=btn],[tpl-section-save=btn],.layui-layer-setwin",function(){d("#section-edit-modal").css("display","none");d("#modify-document-modal").css("display","none");d(".layui-layer").css("display","none")});window.addEventListener("message",function(t){d("#detail_report").css("visibility",t.data.state1);d("#page_navigation").css("visibility",t.data.navState);if(t.data.state1=="visible"||t.data.navState=="visible"){E()}if(t.data.navState=="visible"){var e=k();S(e);x(t.data.pageNum,"false")}if(t.data.PageNum){x(t.data.PageNum,t.data.page_nav_click)}if(t.data.section_edit){d("#section-edit-modal").css("display","block");d("#layui-layer-section").css("display","block");var i=JSON.parse(u(section_edit_json));var a=t.data.section_edit.trim();d(".section-txt.section-txt-prev").text("");d.each(i[a],function(t,e){if(e.score>=.4&&e.score<.7){var i=d('<span class="orange">'+e.content+"</span>")}else if(e.score>=.7){var i=d('<span class="red">'+e.content+"</span>")}else{var i=d("<span>"+e.content+"</span>")}d(".section-txt.section-txt-prev").append(i)});d(".section-id").text(a);var n=o.Paper.textSectionEdit();n.call(this)}if(t.data.modify_document){d("#modify-document-modal").css("display","block");d("#layui-layer-document").css("display","block");d("#modifyDocument").attr("src","htmls/modify_document.html")}})});function z(t){var e=document.documentElement.clientWidth;if(t=="none"){d(".bookmark").css({width:e*.29,left:"auto",right:"72px"})}else{d(".bookmark").css({width:e*.29,left:e*.7-30,right:"auto"})}}E();function E(){var t=document.documentElement.clientWidth;var e=document.documentElement.clientHeight;var i=o.operateState.getTabName(Report.report_id);var a=o.operateState.getFoldState(Report.report_id);var n=d(".paper-header").css("display");if(n=="block"){d(".overflow_ul").css("height",e-220)}if(n=="none"){d(".overflow_ul").css("height",e-120)}if(a=="none"){d(".bookmark").css({width:t*.29,left:"auto",right:"72px"})}else{d(".bookmark").css({width:t*.29,left:t*.7-30,right:"auto"})}}d(window).resize(function(){l();E()})})(Report,jQuery);