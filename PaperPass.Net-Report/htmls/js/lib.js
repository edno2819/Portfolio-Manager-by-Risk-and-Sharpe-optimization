if(!GRN_P){var GRN_P="Report"}(function(t,e,a,n){"use strice";t[e]=a(t,e)})(typeof window!=="undefined"?window:this,GRN_P,function(t,e,a){"use strice";return{}});(function(t,i){var a=null;function e(t){return typeof t!=="undefined"&&t!==null}var r=[],n="cache",o=null;function c(){if(typeof o!=="undefined"){return true}else{return false}}function u(t,e){t=t||r;e=e||n;if(c()){l();o.setItem(e,JSON.stringify(t))}}function l(t){t=t||n;if(c()){o.removeItem(t)}}function s(){if(c()){o.clear()}else{r=[]}}function f(t){t=t||n;if(c()){return JSON.parse(o.getItem(t))||r}else{return r}}function v(t,e){a=this;this.caches=[];n=t||"cache";this.cache_name=n;this.myStorage=e||localStorage}v.prototype={constructor:v,_className:"Cache",init:function(){o=this.myStorage;n=this.cache_name;r=f()},cache:function(t,e,a){this.init();r=f();var n=this.exist(t,e);if(i.isFunction(a)){a.call(this,n)}return n},set:function(t,e,a){this.init();t[e]=a;r.push(t);u()},update:function(t,e){this.init();r[t]=e;u()},get:function(t){this.init();return e(t)?r[t]:r},exist:function(t,e){this.init();for(var a=0,n=r.length;a<n;a++){if(t in r[a]&&e==r[a][t]){return a}}return-1},clear:function(){this.init();this.remove();s()},remove:function(t){this.init();if(t){if(t>-1&&t<r.length-1){r.splice(t,1)}}else{r=[]}u()}};t.Cache=v})(Report,jQuery);(function(t,e){"use strict";var a=window.localStorage;function n(t){t=t+"_s";var e=JSON.parse(a.getItem(t));return e}function i(t,e){t=t+"_s";a.setItem(t,JSON.stringify(e))}function r(){}r.saveId=function(t){var e={Language:"",ALink:"htmls/detail_report.html",HeaderState:"",InitDetailReport:"",DetailNum:"",DetailOffset:"",FoldState:"",LineState:"",TabName:"",DetailSize:"",DetailPageNav:"",ZoomBtnState:"",PageNavState:"",PlainTextLineState:"",PlainTextDetailNum:"",PlainTextDetailOffset:"",PlainTextDetailSize:"",PlainTextZoomBtnState:"",PTPageNavState:""};t=t+"_s";if(a.getItem(t)==null){a.setItem(t,JSON.stringify(e))}else{return}};r.saveLanguage=function(t,e){var a=n(t);a.Language=e;i(t,a)};r.getLanguage=function(t){var e=n(t);return e.Language};r.saveALink=function(t,e){var a=n(t);a.ALink=e;i(t,a)};r.getALink=function(t){var e=n(t);return e.ALink};r.saveTabName=function(t,e){var a=n(t);a.TabName=e;i(t,a)};r.getTabName=function(t){var e=n(t);return e.TabName};r.saveHeaderState=function(t,e){var a=n(t);a.HeaderState=e;i(t,a)};r.getHeaderState=function(t){var e=n(t);return e.HeaderState};r.saveFoldState=function(t,e){var a=n(t);a.FoldState=e;i(t,a)};r.getFoldState=function(t){var e=n(t);return e.FoldState};r.saveInitDetailReport=function(t,e){var a=n(t);a.InitDetailReport=e;i(t,a)};r.getInitDetailReport=function(t){var e=n(t);return e.InitDetailReport};r.saveDetailNum=function(t,e){var a=n(t);a.DetailNum=e;i(t,a)};r.getDetailNum=function(t){var e=n(t);return e.DetailNum};r.saveDetailOffset=function(t,e){var a=n(t);a.DetailOffset=e;i(t,a)};r.getDetailOffset=function(t){var e=n(t);return e.DetailOffset};r.saveLineState=function(t,e){var a=n(t);a.LineState=e;i(t,a)};r.getLineState=function(t){var e=n(t);return e.LineState};r.saveDetailSize=function(t,e){var a=n(t);a.DetailSize=e;i(t,a)};r.getDetailSize=function(t){var e=n(t);return e.DetailSize};r.saveDetailPageNav=function(t,e){var a=n(t);a.DetailPageNav=e;i(t,a)};r.getDetailPageNav=function(t){var e=n(t);return e.DetailPageNav};r.saveZoomBtnState=function(t,e){var a=n(t);a.ZoomBtnState=e;i(t,a)};r.getZoomBtnState=function(t){var e=n(t);return e.ZoomBtnState};r.savePageNavState=function(t,e){var a=n(t);a.PageNavState=e;i(t,a)};r.getPageNavState=function(t){var e=n(t);return e.PageNavState};r.savePlainTextLineState=function(t,e){var a=n(t);a.PlainTextLineState=e;i(t,a)};r.getPlainTextLineState=function(t){var e=n(t);return e.PlainTextLineState};r.savePlainTextDetailNum=function(t,e){var a=n(t);a.PlainTextDetailNum=e;i(t,a)};r.getPlainTextDetailNum=function(t){var e=n(t);return e.PlainTextDetailNum};r.savePlainTextDetailOffset=function(t,e){var a=n(t);a.PlainTextDetailOffset=e;i(t,a)};r.getPlainTextDetailOffset=function(t){var e=n(t);return e.PlainTextDetailOffset};r.savePlainTextDetailSize=function(t,e){var a=n(t);a.PlainTextDetailSize=e;i(t,a)};r.getPlainTextDetailSize=function(t){var e=n(t);return e.PlainTextDetailSize};r.savePlainTextZoomBtnState=function(t,e){var a=n(t);a.PlainTextZoomBtnState=e;i(t,a)};r.getPlainTextZoomBtnState=function(t){var e=n(t);return e.PlainTextZoomBtnState};r.savePTPageNavState=function(t,e){var a=n(t);a.PTPageNavState=e;i(t,a)};r.getPTPageNavState=function(t){var e=n(t);return e.PTPageNavState};t.operateState=r})(Report,jQuery);(function(t,l){"use strict";var s=null;function a(){if(!s){s=new t.Cache(t.report_id,localStorage)}}function e(){}e.sectionEdit=function(c){a();var t={textWarp:"[tpl-section=warp]",text:"[tpl-section=text]",badge:"[tpl-section=badge]",box:"[tpl-section=box]",textarea:"[tpl-section=textarea]",template:'script[type="text/html"][template="section"]'};c=l.isPlainObject(c)?l.extend(t,c):t;var u=null;return function(){u=this;var a="";var t=l(this);var e=t.closest(c.textWarp);var n=e.find(c.badge).data("id");var i=e.find(c.text);var r=e.find(c.box);r.html(l(c.template).html());var o=e.find(c.textarea);s.cache("id",n,function(t){if(-1===t){a=i.text()}else{var e=s.get(t);a=e.text}o.val(l.trim(a));o.text(o.val()).focus()})}};e.textSectionEdit=function(){a();return function(){var a="";var t=l(".section-id").text();var n=l(".section-txt.section-txt-next");n.text("");var e=JSON.parse(section_edit_json);l.each(e[t],function(t,e){a+=e.content});s.cache("id",t,function(t){if(-1===t){a=a}else{var e=s.get(t);a=e.text}n.val(l.trim(a));n.html(n.val())})}};e.sectionSave=function(n){a();var t={warp:'[tpl-section="warp"]',box:'[tpl-section="box"]',badge:'[tpl-section="badge"]',textarea:'[tpl-section="textarea"]'};n=l.isPlainObject(n)?l.extend(t,n):t;var e=null;return function(){var t=l(this).closest(n.warp);var e=t.find(n.textarea).val();e=l.trim(e);var a=t.find(n.badge).data("id");s.cache("id",a,function(t){if(-1===t){s.set({text:e},"id",a)}else{s.update(t,{id:a,text:e})}});t.find(n.box).html("")}};e.textSectionSave=function(){a();return function(){var t=l(this);var e=t.parents("#layui-layer-section").find(".section-id").text();var a=l(".section-txt.section-txt-next").val();a=l.trim(a);s.cache("id",e,function(t){if(-1===t){s.set({text:a},"id",e)}else{s.update(t,{id:e,text:a})}})}};e.tab=function(){var o=null;return function(a){if(o===this){return}var t={li:"li",section:'[tab="section"]',active:"active",callback:function(){}};a=l.isPlainObject(a)?l.extend(t,a):t;o=this;var e=l(this);e.parent().find(a.li).removeClass(a.active);e.addClass(a.active);var n=e.data("id");if(!n){return}var i=n.toString().split(",");var r=l(a.section);r.hide();r.each(function(){var t=l(this);var e=t.data("id");if(l.inArray(e.toString(),i)!==-1){a.callback.call(this);t.show()}})}};e.toggle=function(t,e){var a=l(this).closest("[eve-toggle=warp]").find("[eve-toggle=section]");if(a.css("display")==="none"){if(l.isFunction(t)){t()}a.show()}else{if(l.isFunction(e)){e()}a.hide()}};t.Paper=e})(Report,jQuery);