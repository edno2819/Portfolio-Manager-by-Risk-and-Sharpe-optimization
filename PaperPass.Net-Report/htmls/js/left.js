(function(C,H){H(function(){var o=typeof isHasDetailReport;if(o=="boolean"&&isHasDetailReport==true){if(isWord){var e=C.operateState.getDetailNum(Report.report_id);var t=C.operateState.getDetailOffset(Report.report_id);var i=C.operateState.getDetailSize(Report.report_id);var a=C.operateState.getZoomBtnState(Report.report_id);var n=C.operateState.getLineState(Report.report_id)}else{var e=C.operateState.getPlainTextDetailNum(Report.report_id);var t=C.operateState.getPlainTextDetailOffset(Report.report_id);var i=C.operateState.getPlainTextDetailSize(Report.report_id);var a=C.operateState.getPlainTextZoomBtnState(Report.report_id);var n=C.operateState.getPlainTextLineState(Report.report_id)}}var s=C.operateState.getLanguage(Report.report_id);if(s!=""){s=typeof multilingual[s]=="undefined"?"English":s}else{s=typeof multilingual[user_language]=="undefined"?"English":user_language}r(s);function r(t){H("*[data-lang]").each(function(){var e=H(this).data().lang;H(this).html(multilingual[t][e])})}parent.postMessage("get_language","*");parent.parent.postMessage("get_language","*");var l=`<span class="pageNum">1</span><span class="partition">/</span><span class="totalPage"></span>`;H(".top_Num").html(l);var c=H(".upkmzjakmc").length;H(".totalPage").text(c);H(".top_Num").show();if(o=="boolean"&&isHasDetailReport==true){f(i?i:1);AddH(i?i:1);p(e,t);size=i?i:1;u(a)}function p(e,t){if(e==""||e=="null"){H(".pageNum").text(1);H(".input_pageNum").val(1)}else{H(".pageNum").text(e);H(".input_pageNum").val(e);H("#toall_Num").attr("href","#"+e);H("body").scrollTop(t)}}function u(e){if(e==""||e=="block"){H(".allButton").hide();H(".CollagenButton").hide();H("#menuButton").css("background","#323639")}else{H(".allButton").show();H(".CollagenButton").show();H("#menuButton").css("background","#1b1e1f")}}var d=1;function g(){var a=H("body").scrollTop();var o=-15;H(".upkmzjakmc").each(function(e,t){var i=H(this)[0].getBoundingClientRect().height+15;if(o<a&&a<=o+i){d=e+1}o+=i});H(".pageNum").text(d);H(".input_pageNum").val(d);H("#toall_Num").attr("href","#"+d)}function f(e){_Size=Math.round(e*100)/100;k=Math.round(_Size*100);if(k==""){H(".percent_num").text(100)}else{H(".percent_num").text(k)}H(".upkmzjakmc").css("transform","scale("+_Size+")");if(isWord){if(_Size<1){H(".upkmzjakmc").css("transform-origin","left top")}else{H(".upkmzjakmc").css("transform-origin","center top")}}else{H(".upkmzjakmc").css("transform-origin","left top")}if(d!=undefined){H(".jump_page").attr("href","#"+d)}H(".upkmzjakmc").each(function(e,t){var i=this.getBoundingClientRect().width+30;var a=this.getBoundingClientRect().height+15;H(this).parent(".jcjymywwzd").css("width",i);H(this).parent(".jcjymywwzd").css("height",a)});H("body").off("scroll").on("scroll",function(){g(_Size);var e=H("body").scrollTop();var t=d;var i={PageNum:t,page_nav_click:N};parent.parent.postMessage(i,"*");if(o=="boolean"&&isHasDetailReport==true){if(isWord){C.operateState.saveDetailNum(Report.report_id,t);C.operateState.saveDetailOffset(Report.report_id,e)}else{C.operateState.savePlainTextDetailNum(Report.report_id,t);C.operateState.savePlainTextDetailOffset(Report.report_id,e)}}});var t=_Size;if(o=="boolean"&&isHasDetailReport==true){if(isWord){C.operateState.saveDetailSize(Report.report_id,t)}else{C.operateState.savePlainTextDetailSize(Report.report_id,t)}}}H(".toall_div").mousemove(function(){H(this).css({"background-color":"#424649","border-radius":"2px"});H(this).children(".tip").css("display","block")}).mouseout(function(){H(this).css("background-color","transparent");H(this).children(".tip").css("display","none")});H(".Switch").click(function(){H(".layui-layer-shade").show();H(".layui-layer-title").html(multilingual[s].SwitchMode);H(".detail_btn").data("type","switch");if(isWord){H(".layui-layer-content").html(multilingual[s].TextMode)}else{H(".layui-layer-content").html(multilingual[s].WordMode)}});H(".detail_btn").click(function(){type=H(this).data("type");if(type=="switch"){H(".layui-layer-btn0").attr("href",H(this).data("txtLink"));if(o=="boolean"&&isHasDetailReport==true){if(isWord){C.operateState.saveInitDetailReport(Report.report_id,"text");parent.postMessage("switch-detail-text","*");parent.parent.postMessage("switch-detail-text","*")}else{C.operateState.saveInitDetailReport(Report.report_id,"word");parent.postMessage("switch-detail-word","*");parent.parent.postMessage("switch-detail-word","*")}}}if(type=="subline"){var e=H("span").hasClass("red");var t=H("span").hasClass("orange");if(e==false&&t==false){h("")}else{var i=H(".red").parent().eq(0).hasClass("red_a")||H(".orange").parent().eq(0).hasClass("orange_a");var a=String(i);h(a);if(isWord){C.operateState.saveLineState(Report.report_id,a)}else{C.operateState.savePlainTextLineState(Report.report_id,a)}}}});H(".layui-layer-close, .layui-layer-btn1, .layui-layer-btn0").click(function(){H(".layui-layer-shade").hide()});H(".subline").click(function(){H(".layui-layer-shade").show();H(".layui-layer-title").html(multilingual[s].AuxiliaryLine);H(".detail_btn").data("type","subline");if(H(".red").parent().eq(0).hasClass("red_a")||H(".orange").parent().eq(0).hasClass("orange_a")){H(".layui-layer-content").html(multilingual[s].CancelLine)}else{H(".layui-layer-content").html(multilingual[s].UseLine)}curHref=H(".detail_btn").attr("href");if(curHref!="#"){H(".detail_btn").data("txtLink",H(".detail_btn").attr("href"));H(".layui-layer-btn0").attr("href","#")}});function h(e){if(e==""||e=="true"){H(".red").parent().removeClass("red_a");H(".orange").parent().removeClass("orange_a");H(".subline").css("background-position","-106px -162px")}else{H(".red").parent().addClass("red_a");H(".orange").parent().addClass("orange_a");H(".subline").css("background-position","-146px -159px")}}h(n);H(".bottom").click(function(){H(".bottom_a").attr("href","#"+(d+1));H("#toall_Num").attr("href","#"+(d+1))});H(".top").click(function(){H(".top_a").attr("href","#"+(d-1));H("#toall_Num").attr("href","#"+(d-1))});H(".input_pageNum").focus(function(){H(".input_pageNum").css("background-color","#424649");H(".input_pageNum").select()}).blur(function(){H(".input_pageNum").css("background-color","transparent");page1=H(".input_pageNum").val();if(page1<=c&&/^[1-9]\d*$/.test(page1)){H("#toall_Num").attr("href","#"+page1)}else{H(".input_pageNum").val(d)}}).mousemove(function(){H(".input_pageNum").css("background-color","#424649");H(this).siblings(".tip").css("display","block")}).mouseout(function(){if(H(".input_pageNum").is(":focus")){H(".input_pageNum").css("background-color","#424649")}else{H(".input_pageNum").css("background-color","transparent");H(this).siblings(".tip").css("display","none")}}).keyup(function(){if(event.keyCode==13){page1=H(".input_pageNum").val();if(page1<=c&&/^[1-9]\d*$/.test(page1)){H("#toall_Num").attr("href","#"+page1);window.location.hash="#"+page1}else{H(".input_pageNum").val(d);H(".input_pageNum").blur()}}});var m=C.operateState.getFoldState(Report.report_id);_(m);function _(e){if(e==""||e=="block"){H(".btn_fold_left").css("display","none");H(".btn_fold_right").css("display","block")}else{H(".btn_fold_left").css("display","block");H(".btn_fold_right").css("display","none")}var t={FoldState:e};parent.postMessage(t,"*");parent.parent.postMessage(t,"*");C.operateState.saveFoldState(Report.report_id,e)}H(".btn_fold").click(function(){var e=H(".btn_fold_left").css("display");_size=C.operateState.getDetailSize(Report.report_id);_(e);AddH(_size)});var v=hasScrollbar();if(v){var b=getScrollbarWidth();H(".btn_fold").css("right",b+"px");H("body").css("border-right","0");H(".fixed_shadow").css("width","calc(100% - "+b+"px)")}else{H(".btn_fold").css("right",0+"px");H("body").css("border-right","1px solid #e8e8e8");H(".fixed_shadow").css("width","100%")}H("#originalButton").on("click",function(){H(".zoom-shade").show();size=1;_size=size;f(_size);AddH(_size);z()});H("#fitPageButton").click(function(){H(".zoom-shade").show();var e=H("body")[0].getBoundingClientRect().height;size=(e-20)/minHeight;_size=size;f(_size);AddH(_size);z()});H("#fitWidthButton").click(function(){H(".zoom-shade").show();var e=H("body")[0].getBoundingClientRect().width;size=(e-163)/minWidth;if(size>2){size=2}_size=size;f(_size);AddH(_size);z()});function y(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}var k;H("#zoomOutButton").click(function(){H(".zoom-shade").show();if(k%10==0&&size<=2){size+=.1}if(k%10>=5&&size<=2){size=y(k/100,1)}if(k%10<5&&size<=2){size=y(k/100,1)+.1}if(size>2){size=2}_size=size;f(_size);AddH(_size);z()});H("#zoomInButton").click(function(){H(".zoom-shade").show();if(k%10==0&&size>=.1){size-=.1}else if(k%10>=5&&size>=.1){size=y(k/100,1)-.1}else if(k%10<5&&size>=.1){size=y(k/100,1)}if(size<.1){size=.1}_size=size;f(_size);AddH(_size);z()});H(".allButton").mousemove(function(){H(this).css("background","#1b1e1f");H(this).children(".bot_tip").css("display","block")}).mouseout(function(){H(this).css("background","#323639");H(this).children(".bot_tip").css("display","none")});H("#menuButton").click(function(){var e=H(".allButton").css("display");H(".percent_list").hide();H("#CollagenButton").css("background","#323639");if(o=="boolean"&&isHasDetailReport==true){if(isWord){C.operateState.saveZoomBtnState(Report.report_id,e)}else{C.operateState.savePlainTextZoomBtnState(Report.report_id,e)}}if(e=="block"){H(".allButton").hide();H(".CollagenButton").hide();H("#menuButton").css("background","#323639")}else{H(".allButton").show();H(".CollagenButton").show();H("#menuButton").css("background","#1b1e1f")}}).mousemove(function(){H("#menuButton").css("background","#1b1e1f");H(this).children(".menu_tip").css("display","block")}).mouseout(function(){H(this).children(".menu_tip").css("display","none");if(H(".allButton").css("display")=="block"){H("#menuButton").css("background","#1b1e1f")}else{H("#menuButton").css("background","#323639")}});H("#CollagenButton").click(function(e){var t=H(".percent_list").css("display");if(t=="block"){H(".percent_list").hide();H(this).children(".percent_tip").css("display","block")}else{H(".percent_list").show();H("#CollagenButton").css("background","#1b1e1f")}H(this).children(".percent_tip").css("display","none");e.stopPropagation()}).mousemove(function(){H("#CollagenButton").css("background","#1b1e1f");if(H(".percent_list").css("display")=="block"){H(this).children(".percent_tip").css("display","none")}else{H(this).children(".percent_tip").css("display","block")}}).mouseout(function(){if(H(".percent_list").css("display")=="block"){H("#CollagenButton").css("background","#1b1e1f")}else{H("#CollagenButton").css("background","#323639")}H(this).children(".percent_tip").css("display","none")});H(document).click(function(){H(".percent_list").hide();H("#CollagenButton").css("background","#323639")});H(".zoom-shade").click(function(e){var t=H(".percent_list").css("display");if(t=="block"){H(".percent_list").show()}else{H(".percent_list").hide()}e.stopPropagation()});H(".percent_li").click(function(e){H(".zoom-shade").show();var t=H(this).children(".li_text").text();size=t/100;_size=size;f(_size);AddH(_size);z();e.stopPropagation()}).mousemove(function(){H(this).css("background","#1b1e1f")}).mouseout(function(){H(this).css("background","#323639")});function z(){setTimeout(function(){H(".zoom-shade").hide()},200)}function S(e){return JSON.stringify(JSON.parse(e)).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var w=JSON.parse(S(detail_title_info));if(o=="boolean"&&isHasDetailReport==true){H("#mbxsgxktna a[target='right']").mouseover(function(){var e=`<div class="similarTip"><div>${multilingual[s].Similarity}: <span class="num"></span>%</div></div>`;var t=`<div>${multilingual[s].SimilarityTip} !</div>`;H("#mbxsgxktna").append(e);var i=H(this).data().id;H(this).parent().css("z-index","");var a=C.operateState.getFoldState(Report.report_id);if(a=="none"){H(".similarTip").append(t)}H("div[class='similarTip'] .num").html(w[i].score)}).mouseout(function(){H("div[class='similarTip']").remove()}).mousemove(function(e){var t=e||window.event;var i=document.documentElement.clientWidth;var a=document.documentElement.clientHeight;var o=t.clientY+20;var n=t.clientX+20;if(i-t.clientX<120){n=t.clientX-100}if(a-t.clientY<70){o=t.clientY-50}H("div[class='similarTip']").css({left:n+"px",top:o+"px"})}).click(function(){var e=C.operateState.getFoldState(Report.report_id);if(e=="none"){return false}})}var x=document.querySelector("#mbxsgxktna").cloneNode(true).innerHTML;var R=document.querySelector("style").cloneNode(true).innerHTML;var B={sheetCSS:R,bodyDOM:x};parent.parent.postMessage(B,"*");H(document).on("click",".edit_icon",function(){var e=H(this).prev().text();var t={section_edit:e};parent.parent.postMessage(t,"*")});H(document).on("click",".modify_document",function(){var e={modify_document:true};parent.parent.postMessage(e,"*")});var N="false";window.addEventListener("message",function(e){if(e.data.EnterId){window.location.hash="#"+e.data.EnterId}if(e.data.page_nav_click){N=e.data.page_nav_click}if(e.data.leng){s=e.data.leng;r(s);C.operateState.saveLanguage(Report.report_id,s)}});parent.parent.postMessage("Page_Loading","*")})})(Report,jQuery);function hasScrollbar(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)}function getScrollbarWidth(){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;";document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;document.body.removeChild(e);return t}var arrW=new Array;var arrH=new Array;$(".upkmzjakmc").each(function(e,t){arrW.push($(this).width());arrH.push($(this).height())});function getMaxCountWidth(e){var t=new Array;for(var i in e){var a=e[i];var o=0;if(!t.hasOwnProperty(a)){t[a]=1}else{o=t[a];o=o+1;t[a]=o}}var n=0;var s=0;for(var r in t){var l=t[r];if(l>=n){n=l;if(s==0){s=r}else if(r>s){s=r}}}return s}function getMaxCountHeight(e){var t=new Array;for(var i in e){var a=e[i];var o=0;if(!t.hasOwnProperty(a)){t[a]=1}else{o=t[a];o=o+1;t[a]=o}}var n=0;var s=0;for(var r in t){var l=t[r];if(l>=n){n=l;if(s==0){s=r}else if(r<s){s=r}}}return s}var minWidth=getMaxCountWidth(arrW);var minHeight=getMaxCountHeight(arrH);var size=1;var _size;function AddH(e){var t=document.documentElement.clientWidth;var i=document.documentElement.clientHeight;var a=$(".upkmzjakmc:last")[0].getBoundingClientRect().height+30;var o=i-a;if(a>=i){$("#Add_height").css("height",0)}else{$("#Add_height").css("height",o)}var n=minWidth*e;var s=$(".top_Num").width()+25;var r=(t-n)/2;if(n<=500){r=r-s}else if(n>=t-105){r=77}else{r=r+15}$(".top_Num").css("right",r)}$(window).resize(function(){AddH(size);var e=hasScrollbar();if(e){var t=getScrollbarWidth();$(".btn_fold").css("right",t+"px");$("body").css("border-right","0")}else{$(".btn_fold").css("right",0+"px");$("body").css("border-right","1px solid #e8e8e8")}});